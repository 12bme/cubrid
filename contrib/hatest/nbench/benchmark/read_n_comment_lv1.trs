[tr1:io:select]
SELECT
    BOARD_ID, ARTICLE_ID, ARTICLE_NO, REPLY_NO_SEQ,
    REPLY_DEPTH, ARTICLE_TITLE, ARTICLE_TYPE, ARTICLE_CATEGORY, WRITER_ID,
    WRITER_NICKNAME, WRITER_INFO, POSTED_TIME, HAS_ATTACHMENTS,
    INCR(READ_COUNTER), RECOMMENDED_COUNTER, COMMENT_COUNTER, SCRAP_COUNTER
FROM
    NBD_ARTICLE_INFO
WHERE
    ARTICLE_ID=#article_id#
    AND ARTICLE_STATUS='Normal'
    AND IS_PRIVATE='N'
[tr2:io:select]
SELECT
    CONTENT
FROM
    NBD_CONTENT
WHERE
    ARTICLE_ID=#article_id#
[tr3:io:select]
SELECT
    ATTACHMENT_NO, ATTACHMENT_NAME, ATTACHMENT_TYPE, ATTACHMENT,
    ATTACHMENT_SIZE
FROM
    NBD_ATTACHMENT
WHERE
    ARTICLE_ID=#article_id#
[tr4:io:select]
SELECT
    COMMENT_NO, COMMENT_TEXT, COMMENT_STATUS, WRITER_ID, WRITER_NICKNAME,
    POSTED_TIME, RECOMMENDED_COUNTER
FROM
    NBD_COMMENT
WHERE
    ARTICLE_ID=#article_id#
    AND COMMENT_STATUS='Normal'
    AND INST_NUM()<100
[tr5:io:select]
SELECT
    ARTICLE_ID, ARTICLE_NO, REPLY_NO_SEQ, REPLY_DEPTH,
    ARTICLE_TITLE, PREVIEW_TEXT, THUMBNAIL_IMAGE, ARTICLE_TYPE,
    ARTICLE_CATEGORY, ARTICLE_STATUS, WRITER_ID, WRITER_NICKNAME,
    POSTED_TIME, HAS_ATTACHMENTS, IS_SCRAPED, IS_POPULAR,
    READ_COUNTER, RECOMMENDED_COUNTER, COMMENT_COUNTER, SCRAP_COUNTER
FROM
	NBD_ARTICLE_INFO
WHERE
    BOARD_ID=#board_id#
    AND ARTICLE_NO BETWEEN #article_no#-50 AND #article_no#-1
	AND REPLY_DEPTH=0
	AND ARTICLE_CATEGORY=#article_category#
	AND ARTICLE_STATUS='Normal'
	AND IS_PRIVATE='N'
	AND INST_NUM()=1
USING INDEX i_nbd_article_info_board_id_article_category_article_no(+)
UNION ALL
SELECT
    ARTICLE_ID, ARTICLE_NO, REPLY_NO_SEQ, REPLY_DEPTH,
    ARTICLE_TITLE, PREVIEW_TEXT, THUMBNAIL_IMAGE, ARTICLE_TYPE,
    ARTICLE_CATEGORY, ARTICLE_STATUS, WRITER_ID, WRITER_NICKNAME,
    POSTED_TIME, HAS_ATTACHMENTS, IS_SCRAPED, IS_POPULAR,
    READ_COUNTER, RECOMMENDED_COUNTER, COMMENT_COUNTER, SCRAP_COUNTER
FROM
    NBD_ARTICLE_INFO
WHERE
    BOARD_ID=#board_id#
    AND ARTICLE_NO BETWEEN #article_no#+1 AND #article_no#+50
    AND REPLY_DEPTH=0
    AND ARTICLE_CATEGORY=#article_category#
    AND ARTICLE_STATUS='Normal'
    AND IS_PRIVATE='N'
    AND INST_NUM()=1
USING INDEX ri_nbd_article_info_board_id_article_category_article_no(+)
[tr6:io:select]
SELECT
    REPLY_NO_SEQ, REPLY_DEPTH, ARTICLE_TITLE, PREVIEW_TEXT,
    THUMBNAIL_IMAGE, ARTICLE_TYPE, ARTICLE_CATEGORY, ARTICLE_STATUS,
    WRITER_ID, WRITER_NICKNAME, POSTED_TIME,
    HAS_ATTACHMENTS, IS_SCRAPED, IS_POPULAR,
    READ_COUNTER, RECOMMENDED_COUNTER, COMMENT_COUNTER, SCRAP_COUNTER
FROM
    NBD_ARTICLE_INFO
WHERE
    BOARD_ID=#board_id#
    AND ARTICLE_NO=-#article_no#
    AND REPLY_NO_SEQ LIKE #reply_no_seq#||'%'
    AND REPLY_DEPTH>#reply_depth#
    AND ARTICLE_CATEGORY=#article_category#
    AND ARTICLE_STATUS='Normal'
    AND IS_PRIVATE='N'
[tr7:io:select]
SELECT
    COUNT(*) AS COUNT_ALL
FROM
    NBD_ARTICLE_INFO
WHERE
    BOARD_ID=#board_id_lv#
    AND ARTICLE_CATEGORY=#article_category_lv#
[tr8:io:select]
SELECT
    ARTICLE_ID, ARTICLE_NO AS ARTICLE_NO, REPLY_NO_SEQ, REPLY_DEPTH,
    ARTICLE_TITLE, PREVIEW_TEXT, THUMBNAIL_IMAGE, ARTICLE_TYPE,
    ARTICLE_CATEGORY, WRITER_ID, WRITER_NICKNAME, WRITER_INFO,
    POSTED_TIME, HAS_ATTACHMENTS, IS_SCRAPED, IS_POPULAR,
    READ_COUNTER, RECOMMENDED_COUNTER, COMMENT_COUNTER, SCRAP_COUNTER
FROM
    NBD_ARTICLE_INFO
WHERE
    BOARD_ID=#board_id#
    AND ARTICLE_CATEGORY=#article_category#
    AND ARTICLE_STATUS='Normal'
    AND IS_PRIVATE='N'
    AND INST_NUM() BETWEEN #page_start_no# AND #page_end_no#
USING INDEX u_nbd_article_info_board_id_article_category_article_no_reply_depth_reply_no_seq_posted_time(+)
[tr9:i:insert]
INSERT INTO NBD_COMMENT (COMMENT_NO, BOARD_ID, ARTICLE_ID, COMMENT_TEXT, COMMENT_STATUS, WRITER_ID, WRITER_NICKNAME,
    POSTED_TIME, RECOMMENDED_COUNTER)
SELECT MAX(COMMENT_NO)+1, #board_id#, #article_id#, 'COMMENT_XXX', 'Normal', 'USER_4968', 'NICK_USER_4968',
    current_timestamp, 0 FROM NBD_COMMENT
WHERE article_id = #article_id#
[tr10:io:select]
SELECT
    COMMENT_NO, COMMENT_TEXT, COMMENT_STATUS, WRITER_ID, WRITER_NICKNAME,
    POSTED_TIME, RECOMMENDED_COUNTER
FROM
    NBD_COMMENT
WHERE
    ARTICLE_ID=#article_id#
    AND COMMENT_STATUS='Normal'
    AND INST_NUM()<100

