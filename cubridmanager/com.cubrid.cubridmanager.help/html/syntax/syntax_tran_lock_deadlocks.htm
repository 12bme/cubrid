
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta name="layout-height" content="25810" />
<meta name="layout-width" content="1072" />
<title>트랜잭션 교착 상태</title>
<link href="../nhelp.css" rel="Stylesheet" type="text/css" />
 <meta name="generator" content="Adobe RoboHelp 8" />
<script type="text/javascript" language="JavaScript">
//<![CDATA[
function reDo() {
  if (innerWidth != origWidth || innerHeight != origHeight)
     location.reload();
}
if ((parseInt(navigator.appVersion) == 4) && (navigator.appName == "Netscape")) {
	origWidth = innerWidth;
	origHeight = innerHeight;
	onresize = reDo;
}
onerror = null; 
//]]>
</script>
<style type="text/css">
<!--
div.WebHelpPopupMenu { position:absolute;
left:0px;
top:0px;
z-index:4;
visibility:hidden; }
-->
</style>
<script type="text/javascript" language="javascript1.2" src="../whmsg.js"></script>
<script type="text/javascript" language="javascript" src="../whver.js"></script>
<script type="text/javascript" language="javascript1.2" src="../whproxy.js"></script>
<script type="text/javascript" language="javascript1.2" src="../whutils.js"></script>
<script type="text/javascript" language="javascript1.2" src="../whlang.js"></script>
<script type="text/javascript" language="javascript1.2" src="../whtopic.js"></script>

</head>
<body><script type="text/javascript" language="javascript1.2">//<![CDATA[
<!--
if (window.gbWhTopic)
{
	var strUrl = document.location.href;
	var bc = 0;
	var n = strUrl.toLowerCase().indexOf("bc-");
	if(n != -1)
	{
		document.location.href = strUrl.substring(0, n);
		bc = strUrl.substring(n+3);
	}

	if (window.addTocInfo)
	{
	addTocInfo("CUBRID SQL 설명서\n트랜잭션 관리\n잠금 프로토콜\n트랜잭션 교착 상태");
         if(strUrl.toLowerCase().indexOf("/help/")==-1){

    addButton("show",BTN_TEXT,"Show","","","","",0,0,"","","");

    }


	}
	if (window.writeBtnStyle)
		writeBtnStyle();

	if (window.writeIntopicBar)
		writeIntopicBar(1);if(strUrl.toLowerCase().indexOf("/help/")==-1){

         document.write("<p style=\"text-align:left\"> ");

AddMasterBreadcrumbs("../index.htm", "", "&nbsp;&gt;&nbsp;", "홈", "../cubrid.htm");

document.write("<a href=\"syntax.htm\">CUBRID SQL 설명서<\/a> &nbsp;&gt;&nbsp; <a href=\"syntax_tran_intro.htm\">트랜잭션 관리<\/a> &nbsp;&gt;&nbsp; <a href=\"syntax_tran_lock_intro.htm\">잠금 프로토콜<\/a> &nbsp;&gt;&nbsp; 트랜잭션 교착 상태<\/p>");}


	if (window.setRelStartPage)
	{
	setRelStartPage("../index.htm");

		autoSync(1);
		sendSyncInfo();
		sendAveInfoOut();
	}
}
else
	if (window.gbIE4)
		document.location.reload();

//-->
//]]></script>
<h4>트랜잭션 교착 상태</h4>
<p>둘 또는 그 이상의 트랜잭션이 서로 끝나기를(커밋 또는&#160;롤백) 기다리는 상황이 발생할 수 있다. 이 경우 트랜잭션이 서로 진행을 못하게 하기 때문에 교착 상태라고 부른다. 교착 상태가 발생하면 CUBRID는 트랜잭션 중 하나를 롤백시켜 교착 상태를 해결한다. 롤백되는 트랜잭션은 일반적으로 가장 적은 갱신을 수행한 것인데 보통 가장 최근에 시작된 트랜잭션이다.</p>
<p>시스템에 의해 트랜잭션이 롤백되자마자&#160;그 트랜잭션이 가지고 있던 잠금이 해제되고 교착 상태에 있던 다른 트랜잭션이 진행되도록 허가된다. 교착 상태 상황은 비주기적이고 예측 불가능하다. 하지만 교착 상태의 가능성이 있는 경우에는 동일한 데이터를 동시에 갱신하고자 하는 사용자의 수가 증가한다.</p>
<h6>예제</h6>
<p><span class="keyword">isolation_level</span> = 6 (<span class="keyword">SERIALIZABLE</span>), <span class="keyword">AUTOCOMMIT</span>은 OFF인 상황이다.</p>
<p>두 사용자가 동시에 동일한 데이터를 갱신하려고 시도한다고 가정하자. 이 예제에서 User1 (T1)은 participant2 클래스를 생성하고 몇 개의 인스턴스를 삽입한다. User1 (T1)과 User2 (T2)는 participant2 클래스에 질의를 하여 동일한 결과를 얻는다.</p>
<p>User1 (T1)</p>
<p class="code">;autocommit off<br />
SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;<br />
create class participant2(host_year integer, nation_code char(3), gold integer, silver integer, bronze integer)<br />
insert into participant2 (host_year, nation_code, gold, silver, bronze) values (2008, 'KOR', 20,10,10);<br />
insert into participant2 (host_year, nation_code, gold, silver, bronze) values (2008, 'NED', 12,22,18);<br />
insert into participant2 (host_year, nation_code, gold, silver, bronze) values (2008, 'GER', 13,17,19);<br />
commit work;<br />
;xrun<br />
select * from participant2;<br />
;xrun<br />
……<br />
<span class="var">1 command(s) successfully processed.</span></p>
<p>User2 (T2) :</p>
<p class="code">;autocommit off<br />
SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;<br />
select host_year, nation_code from participant2;<br />
<span class="var">=== &lt;Result of SELECT Command in Line 2&gt; ===<br />
&#160;&#160;&#160;&#160;host_year &#160;nation_code<br />
===================================<br />
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;2008 &#160;'KOR'<br />
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;2008 &#160;'NED'<br />
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;2008 &#160;'GER'<br />
3 rows selected.</span></p>
<p>다음으로 User1은 participant2 클래스에서 'GER' 인스턴스를 삭제하려고 시도하지만 User2가 커밋이나 중단을 하지 않았기 때문에 할 수가 없다. &#160;User2가 participant2 클래스에 인스턴스를 삽입하려고 시도하지만 User2 역시 User1이 커밋이나 중단을 하지 않았기 때문에 할 수가 없다. 시스템은 이 교착 상태를 User1의 트랜잭션을 중단하여 해결한다.</p>
<p>User1 (T1):</p>
<p class="code">delete from participant2 where host_year=2008 and nation_code = 'GER';<br />
;xrun<br />
------- &lt;T2가 ;xrun 실행 후 T1은 트랜잭션을 중단함&gt;<br />
<span class="var">In line 1, column 1,<br />
ERROR: Your transaction (index 2, brightes@cdbs006.cub|27967) has been unilaterally aborted by the system.<br />
0 command(s) successfully processed.</span></p>
<p>User2 (T2)</p>
<p class="code">insert into participant2 (host_year, nation_code, gold, silver, bronze) values (2008, 'AUS', 13,17,19);<br />
;xrun</p>
<script type="text/javascript" language="javascript1.2">//<![CDATA[
<!--
if (window.writeIntopicBar)
	writeIntopicBar(0);


highlightSearch();
//-->
//]]></script>
</body>
</html>
