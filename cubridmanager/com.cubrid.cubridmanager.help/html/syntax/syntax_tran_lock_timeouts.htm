
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<meta name="layout-height" content="25810" />
<meta name="layout-width" content="1072" />
<title>트랜잭션 타임아웃</title>
<link href="../nhelp.css" rel="Stylesheet" type="text/css" />
 <meta name="generator" content="Adobe RoboHelp 8" />
<script type="text/javascript" language="JavaScript">
//<![CDATA[
function reDo() {
  if (innerWidth != origWidth || innerHeight != origHeight)
     location.reload();
}
if ((parseInt(navigator.appVersion) == 4) && (navigator.appName == "Netscape")) {
	origWidth = innerWidth;
	origHeight = innerHeight;
	onresize = reDo;
}
onerror = null; 
//]]>
</script>
<style type="text/css">
<!--
div.WebHelpPopupMenu { position:absolute;
left:0px;
top:0px;
z-index:4;
visibility:hidden; }
-->
</style>
<script type="text/javascript" language="javascript1.2" src="../whmsg.js"></script>
<script type="text/javascript" language="javascript" src="../whver.js"></script>
<script type="text/javascript" language="javascript1.2" src="../whproxy.js"></script>
<script type="text/javascript" language="javascript1.2" src="../whutils.js"></script>
<script type="text/javascript" language="javascript1.2" src="../whlang.js"></script>
<script type="text/javascript" language="javascript1.2" src="../whtopic.js"></script>

</head>
<body><script type="text/javascript" language="javascript1.2">//<![CDATA[
<!--
if (window.gbWhTopic)
{
	var strUrl = document.location.href;
	var bc = 0;
	var n = strUrl.toLowerCase().indexOf("bc-");
	if(n != -1)
	{
		document.location.href = strUrl.substring(0, n);
		bc = strUrl.substring(n+3);
	}

	if (window.addTocInfo)
	{
	addTocInfo("CUBRID SQL 설명서\n트랜잭션 관리\n잠금 프로토콜\n트랜잭션 타임아웃");
         if(strUrl.toLowerCase().indexOf("/help/")==-1){

    addButton("show",BTN_TEXT,"Show","","","","",0,0,"","","");

    }


	}
	if (window.writeBtnStyle)
		writeBtnStyle();

	if (window.writeIntopicBar)
		writeIntopicBar(1);if(strUrl.toLowerCase().indexOf("/help/")==-1){

         document.write("<p style=\"text-align:left\"> ");

AddMasterBreadcrumbs("../index.htm", "", "&nbsp;&gt;&nbsp;", "홈", "../cubrid.htm");

document.write("<a href=\"syntax.htm\">CUBRID SQL 설명서<\/a> &nbsp;&gt;&nbsp; <a href=\"syntax_tran_intro.htm\">트랜잭션 관리<\/a> &nbsp;&gt;&nbsp; <a href=\"syntax_tran_lock_intro.htm\">잠금 프로토콜<\/a> &nbsp;&gt;&nbsp; 트랜잭션 타임아웃<\/p>");}


	if (window.setRelStartPage)
	{
	setRelStartPage("../index.htm");

		autoSync(1);
		sendSyncInfo();
		sendAveInfoOut();
	}
}
else
	if (window.gbIE4)
		document.location.reload();

//-->
//]]></script>
<h4>트랜잭션 타임아웃</h4>
<p>CUBRID는 잠금의 타임아웃 기능을 제공한다. 응용 프로그램은 잠금을 기다리는 최소한의 시간을 CUBRID에 알려줄 수 있는데, <a href="../pm/pm_db_classify_lock.htm"><span class="keyword">lock_timeout_in_secs</span></a> 시스템 매개변수나 <span class="keyword">SET TRANSACTION</span> 문을 통해 할 수 있다. 타임아웃 값이 주어지지 않으면 기본 값은 잠금이 허용되거나 트랜잭션이 교착 상태로 인해 롤백될 때까지 무한정 기다리는 것이다.</p>
<p>만약 명시된 시간 내에 잠금이 허용되지 않으면 잠금은 거부되고 연산의 수행은 취소된다. CUBRID는 잠금 타임아웃으로 인해 연산이 취소되었음을 알리는 에러를 반환한다.</p>
<p>명시된 타임아웃 값이 있는 트랜잭션이 교착 상태에 빠지게 되면 CUBRID는 롤백 대신 타임아웃으로 그 트랜잭션을 선택한다. 만약 교착 상태에 있는 여러 트랜잭션이 만료된 타임아웃 값을 가지고 있으면 CUBRID는 타임아웃 만료에 가장 가까운 것을 선택하려고 한다. 그러므로 타임아웃은 무한정 잠금을 기다리거나 트랜잭션이 시스템에 의해 롤백되는 것을 방지하는데 사용될 수 있다.</p>
<h5>타임아웃 값 설정</h5>
<p>아래는 <span class="keyword">SET TRANSACTION</span> 문의 구문이다.</p>
<h6>구문</h6>
<p class="syntax"><span class="keyword">SET TRANSACTION LOCK TIMEOUT</span> <span class="var">timeout_spec</span> [ ; ]<br />
<span class="var">timeout_spec</span>:<br />
_ <span class="keyword">INFINITE</span><br />
_ <span class="keyword">OFF</span><br />
_ <span class="var">unsigned_integer</span><br />
_ <span class="var">variable</span></p>
<p>만약 <span class="var">timeout_spec</span>에 <span class="keyword">INFINITE</span>(기본 값)를 설정하면 트랜잭션은 잠금이 허용되거나 트랜잭션이 교착 상태로 인해 롤백될 때까지 무한정 기다린다. 만약 <span class="keyword">OFF</span>로 설정되면 다른 트랜잭션이 호환되지 않는 잠금을 가지고 있을 때 잠금을 기다리지 않는다. 이 경우에 잠금은 거부되고 연산의 수행은 취소된다. 만약 잠금이 <span class="var">unsigned_integer</span>로 명시된 시간(초 단위) 내에 허용되지 않으면 잠금은 거부되고 연산은 취소된다. <span class="var">variable</span>을 이 문에 사용하면 트랜잭션은 이 변수에 저장된 값만큼의 시간 동안 잠금이 허용되길 기다린다. 만약 연산이 취소되면 CUBRID는 잠금 타임아웃으로 인해 연산이 취소되었음을 알리는 오류를 반환한다.</p>
<h5>타임아웃 값 얻기</h5>
<p>타임아웃 값을 설정하는 것 외에도 <span class="keyword">GET TRANSACTION</span> 문을 이용하여 특정 트랜잭션에 설정된 타임아웃 값을 얻어올 수도 있다.</p>
<h6>구문</h6>
<p class="syntax">GET TRANSACTION LOCK TIMEOUT [ { INTO | TO } variable ] [ ; ]</p>
<p>이 명령문은 타임아웃 매개변수의 값을 가져와 명시된 변수에 할당할 수 있다.</p>
<h5>잠금 타임아웃 에러 메시지</h5>
<p>잠금 요청이 차단 되었다가 타임아웃이 발생하면(CSQL에서 잠금이 차단 되었을 때 &lt;Ctrl+C&gt; 키를 누른 경우나, <span class="keyword">lock_timeout_in_secs</span> 값이 –1이 아닌 트랜잭션이 <span class="keyword">lock_timeout_in_secs</span>에 도달하는 경우 타임아웃이 발생한다) 잠금 요청을 차단시킨 다른 트랜잭션들의 정보가 에러로 출력된다. 트랜잭션들의 정보를 출력하려면 <span class="keyword">lock_timeout_message_type</span> 시스템 인자를 수정하면 된다. 이 값은 <span class="keyword">0</span>이 기본값이다. 1이면 차단시킨 트랜잭션들 중 하나의 정보만 출력되고, 2이면 차단시킨 모든 트랜잭션들의 정보가 다 출력된다.</p>
<p>다음은 격리수준을 <span class="keyword">SERIALIZABLE</span>로 설정하고, <span class="keyword">lock_timeout_message_type</span>의 값을 바꾸면서 테스트해 본 결과이다. <span class="keyword">lock_timeout_message_type</span> 값을 변경하고 적용하려면 데이터베이스 서버를 재시작해야 한다.</p>
<p>&#160;0일 경우 다음과 같은 에러 메시지가 출력된다.</p>
<p class="code">ERROR: Your transaction (index 3, brightes@cdbs006.cub|15668) timed out waiting on &#160;&#160;&#160;X_LOCK lock on instance 0|636|34 of class participant. You are waiting for user(s) &#160;to finish.</p>
<p>1인 경우 다음과 같은 에러 메시지가 출력된다.</p>
<p class="code">ERROR: Your transaction (index 3, brightes@cdbs006.cub|15668) timed out waiting on &#160;&#160;&#160;X_LOCK lock on instance 0|636|34 of class participant. You are waiting for user(s) brightes@cdbs006.cub|15615 to finish.</p>
<p>2인 경우 다음과 같은 에러 메시지가 출력된다.</p>
<p class="code">ERROR: Your transaction (index 3, brightes@cdbs006.cub|15668) timed out waiting on &#160;&#160;&#160;X_LOCK lock on instance 0|636|34 of class participant. You are waiting for user(s) brightes@cdbs006.cub|15615, brightes@cdbs006.cub|15596 to finish.</p>
<script type="text/javascript" language="javascript1.2">//<![CDATA[
<!--
if (window.writeIntopicBar)
	writeIntopicBar(0);


highlightSearch();
//-->
//]]></script>
</body>
</html>
