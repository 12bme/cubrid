
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<title>ASP 예제 프로그램</title>
<link href="../nhelp.css" rel="Stylesheet" type="text/css" />
<script type="text/javascript" language="JavaScript">
//<![CDATA[
function reDo() {
  if (innerWidth != origWidth || innerHeight != origHeight)
     location.reload();
}
if ((parseInt(navigator.appVersion) == 4) && (navigator.appName == "Netscape")) {
	origWidth = innerWidth;
	origHeight = innerHeight;
	onresize = reDo;
}
onerror = null; 
//]]>
</script>
<style type="text/css">
<!--
div.WebHelpPopupMenu { position:absolute;
left:0px;
top:0px;
z-index:4;
visibility:hidden; }
-->
</style>
<script type="text/javascript" language="javascript1.2" src="../whmsg.js"></script>
<script type="text/javascript" language="javascript" src="../whver.js"></script>
<script type="text/javascript" language="javascript1.2" src="../whproxy.js"></script>
<script type="text/javascript" language="javascript1.2" src="../whutils.js"></script>
<script type="text/javascript" language="javascript1.2" src="../whlang.js"></script>
<script type="text/javascript" language="javascript1.2" src="../whtopic.js"></script>

 <meta name="generator" content="Adobe RoboHelp 8" />
</head>
<body><script type="text/javascript" language="javascript1.2">//<![CDATA[
<!--
if (window.gbWhTopic)
{
	var strUrl = document.location.href;
	var bc = 0;
	var n = strUrl.toLowerCase().indexOf("bc-");
	if(n != -1)
	{
		document.location.href = strUrl.substring(0, n);
		bc = strUrl.substring(n+3);
	}

	if (window.addTocInfo)
	{
	addTocInfo("CUBRID 시작\nODBC와 ASP를 이용한 프로그램 작성\nASP 예제 프로그램");
         if(strUrl.toLowerCase().indexOf("/help/")==-1){

    addButton("show",BTN_TEXT,"Show","","","","",0,0,"","","");

    }


	}
	if (window.writeBtnStyle)
		writeBtnStyle();

	if (window.writeIntopicBar)
		writeIntopicBar(1);if(strUrl.toLowerCase().indexOf("/help/")==-1){

         document.write("<p style=\"text-align:left\"> ");

AddMasterBreadcrumbs("../index.htm", "", "&nbsp;&gt;&nbsp;", "홈", "../cubrid.htm");

document.write("<a href=\"gs.htm\">CUBRID 시작<\/a> &nbsp;&gt;&nbsp; <a href=\"gs_app_odbc_setting.htm\">ODBC와 ASP를 이용한 프로그램 작성<\/a> &nbsp;&gt;&nbsp; ASP 예제 프로그램<\/p>");}


	if (window.setRelStartPage)
	{
	setRelStartPage("../index.htm");

		autoSync(1);
		sendSyncInfo();
		sendAveInfoOut();
	}
}
else
	if (window.gbIE4)
		document.location.reload();

//-->
//]]></script>
<h4>ASP 예제 프로그램</h4>
<p>ASP 예제를 실행할 가상 디렉터리의 '기본 웹 사이트' 항목에서 마우스 오른쪽 버튼을 클릭한 뒤 [속성]을 클릭한다.<br />
<img title="image017.png" src="images/gs_app_odbc_asp_website.png" width="429" height="345" border="0" alt="" />&#160;</p>
<p></p>
<p>위의 그림에서 <span class="keyword">웹사이트 확인</span> 아래 <span class="keyword">IP 주소</span>를 '(모두 할당되지 않음)'으로 선택하면 localhost로 인식한다. 특정한 IP 주소를 통해 예제를 확인하려면 해당 IP에 해당 디렉터리를 가상 디렉터리로 인식시키고 등록 정보에 IP 주소를 등록한다.</p>
<p>다음은 IP 주소를 localhost로 설정한 예제이다.</p>
<h6>예제</h6>
<p>아래의 예제 코드를 cubrid.asp로 만들고 가상 디렉터리에 저장한다.</p>
<p class="code">&lt;HTML&gt;<br />
&#160;&#160;&#160; &lt;HEAD&gt;<br />
&#160;&#160;&#160;&#160;&#160;&lt;meta http-equiv="Content-Type" content="text/html; charset=EUC-KR"&gt;<br />
&#160;&#160;&#160;&#160;&#160;&#160; &lt;title&gt;CUBRID Query Test Page&lt;/title&gt;<br />
&#160;&#160;&lt;/HEAD&gt;<br />
<br />
&#160;&lt;BODY topmargin="0" leftmargin="0"&gt;<br />
&#160;&#160;&#160;<br />
&#160;&lt;table border="0" width="748" cellspacing="0" cellpadding="0"&gt;<br />
&#160;&#160; &lt;tr&gt;<br />
&#160;&#160;&#160;&#160; &lt;td width="200"&gt;&lt;/td&gt;<br />
&#160;&#160;&#160;&#160; &lt;td width="287"&gt;<br />
&#160;&#160;&#160;&#160;&#160;&#160; &lt;p align="center"&gt;&lt;font size="3" face="Times New Roman"&gt;&lt;b&gt;&lt;font color="#FF0000"&gt;CUBRID&lt;/font&gt;Query Test&lt;/b&gt;&lt;/font&gt;&lt;/td&gt;<br />
&#160;&#160;&#160;&#160; &lt;td width="200"&gt;&lt;/td&gt;<br />
&#160;&#160; &lt;/tr&gt;<br />
&#160;&lt;/table&gt;<br />
<br />
&#160;&lt;form action="cubrid.asp" method="post" &gt;<br />
&#160;&lt;table border="1" width="700" cellspacing="0" cellpadding="0" height="45"&gt;<br />
&#160;&#160; &lt;tr&gt;<br />
&#160;&#160;&#160;&#160; &lt;td width="113" valign="bottom" height="16" bgcolor="#DBD7BD" bordercolorlight="#FFFFCC"&gt;&lt;font size="2"&gt;SERVER IP&lt;/font&gt;&lt;/td&gt;<br />
&#160;&#160;&#160;&#160; &lt;td width="78"&#160; valign="bottom" height="16" bgcolor="#DBD7BD" bordercolorlight="#FFFFCC"&gt;&lt;font size="2"&gt;Broker PORT&lt;/font&gt;&lt;/td&gt;<br />
&#160;&#160;&#160;&#160; &lt;td width="148" valign="bottom" height="16" bgcolor="#DBD7BD" bordercolorlight="#FFFFCC"&gt;&lt;font size="2"&gt;DB NAME&lt;/font&gt;&lt;/td&gt;<br />
&#160;&#160;&#160;&#160; &lt;td width="113" valign="bottom" height="16" bgcolor="#DBD7BD" bordercolorlight="#FFFFCC"&gt;&lt;font size="2"&gt;DB USER&lt;/font&gt;&lt;/td&gt;<br />
&#160;&#160;&#160;&#160; &lt;td width="113" valign="bottom" height="16" bgcolor="#DBD7BD" bordercolorlight="#FFFFCC"&gt;&lt;font size="2"&gt;DB PASS&lt;/font&gt;&lt;/td&gt;<br />
&#160;&#160;&#160;&#160; &lt;td width="80" height="37" rowspan="4" bordercolorlight="#FFFFCC" bgcolor="#F5F5ED"&gt;　<br />
&#160;&#160;&#160;&#160;&#160;&#160; &lt;p&gt;&lt;input type="submit" value="실행하기" name="B1" tabindex="7"&gt;&lt;/p&gt;&lt;/td&gt;<br />
&#160;&#160; &lt;/tr&gt;<br />
&#160;&#160; &lt;tr&gt;<br />
&#160;&#160;&#160;&#160; &lt;td width="113" height="1" bordercolorlight="#FFFFCC" bgcolor="#F5F5ED"&gt;&lt;font size="2"&gt;&lt;input type="text" name="server_ip" size="20" tabindex="1" maxlength="15" value="&lt;%=Request("server_ip")%&gt;"&gt;&lt;/font&gt;&lt;/td&gt;<br />
&#160;&#160;&#160;&#160; &lt;td width="78"&#160; height="1" bordercolorlight="#FFFFCC" bgcolor="#F5F5ED"&gt;&lt;font size="2"&gt;&lt;input type="text" name="cas_port" size="15" tabindex="2" maxlength="6" value="&lt;%=Request("cas_port")%&gt;"&gt;&lt;/font&gt;&lt;/td&gt;<br />
&#160;&#160;&#160;&#160; &lt;td width="148" height="1" bordercolorlight="#FFFFCC" bgcolor="#F5F5ED"&gt;&lt;font size="2"&gt;&lt;input type="text" name="db_name" size="20" tabindex="3" maxlength="20" value="&lt;%=Request("db_name")%&gt;"&gt;&lt;/font&gt;&lt;/td&gt;<br />
&#160;&#160;&#160;&#160; &lt;td width="113" height="1" bordercolorlight="#FFFFCC" bgcolor="#F5F5ED"&gt;&lt;font size="2"&gt;&lt;input type="text" name="db_user" size="15" tabindex="4" value="&lt;%=Request("db_user")%&gt;"&gt;&lt;/font&gt;&lt;/td&gt;<br />
&#160;&#160;&#160;&#160; &lt;td width="113" height="1" bordercolorlight="#FFFFCC" bgcolor="#F5F5ED"&gt;&lt;font size="2"&gt;&lt;input type="password" name="db_pass" size="15" tabindex="5" value="&lt;%=Request("db_pass")%&gt;"&gt;&lt;/font&gt;&lt;/td&gt;<br />
&#160;&#160; &lt;/tr&gt;<br />
&#160;&#160; &lt;tr&gt;<br />
&#160;&#160;&#160;&#160; &lt;td width="573" colspan="5" valign="bottom" height="18" bordercolorlight="#FFFFCC" bgcolor="#DBD7BD"&gt;&lt;font size="2"&gt;QUERY&lt;/font&gt;&lt;/td&gt;<br />
&#160;&#160; &lt;/tr&gt;<br />
&#160;&#160; &lt;tr&gt;<br />
&#160;&#160;&#160;&#160; &lt;td width="573" colspan="5" height="25" bordercolorlight="#FFFFCC" bgcolor="#F5F5ED"&gt;&lt;textarea rows="3" name="query" cols="92" tabindex="6"&gt;&lt;%=Request("query")%&gt;&lt;/textarea&gt;&lt;/td&gt;<br />
&#160;&#160; &lt;/tr&gt;<br />
&#160;&lt;/table&gt;<br />
&#160;&lt;/form&gt;<br />
&#160;&lt;hr&gt;<br />
<br />
&lt;/BODY&gt;<br />
&lt;/HTML&gt;<br />
<br />
&lt;%<br />
&#160;&#160;&#160; ' DSN과 SQL문을 가져온다.<br />
&#160;&#160;&#160; strIP = Request( "server_ip" )<br />
&#160;&#160;&#160; strPort = Request( "cas_port" )<br />
&#160;&#160;&#160; strUser = Request( "db_user" )<br />
&#160;&#160;&#160; strPass = Request( "db_pass" )<br />
&#160;&#160;&#160; strName = Request( "db_name" )<br />
&#160;&#160;&#160; strQuery = Request( "query" )<br />
&#160;&#160;&#160;<br />
if strIP = "" then<br />
&#160;&#160; Response.Write "SERVER_IP를 입력하세요"<br />
&#160;&#160;&#160;&#160;&#160;&#160;&#160; Response.End ' IP가 없으면 페이지 종료<br />
&#160;&#160;&#160; end if<br />
&#160;&#160;&#160; if strPort = "" then<br />
&#160;&#160;&#160; &#160;&#160; Response.Write "Port 번호를 입력하세요"<br />
&#160;&#160;&#160;&#160;&#160;&#160;&#160; Response.End ' Port가 없으면 페이지 종료<br />
&#160;&#160;&#160; end if<br />
&#160;&#160;&#160; if strUser = "" then<br />
&#160;&#160;&#160; &#160;&#160; Response.Write "DB_USER를 입력하세요"<br />
&#160;&#160;&#160;&#160;&#160;&#160;&#160; Response.End ' DB_User가 없으면 페이지 종료<br />
&#160;&#160;&#160; end if<br />
&#160;&#160;&#160; if strName = "" then<br />
&#160;&#160;&#160; &#160;&#160; Response.Write "DB_NAME을 입력하세요"<br />
&#160;&#160;&#160;&#160;&#160;&#160;&#160; Response.End ' DB_NAME이 없으면 페이지 종료<br />
&#160;&#160;&#160; end if<br />
&#160;&#160;&#160; if strQuery = "" then<br />
&#160;&#160;&#160; &#160;&#160; Response.Write "확인하고자 하는 Query를 입력하세요"<br />
&#160;&#160;&#160;&#160;&#160;&#160;&#160; Response.End ' Query가 없으면 페이지 종료<br />
&#160;&#160;&#160; end if<br />
&#160;' 연결 객체 생성<br />
&#160;&#160;strDsn = "driver={CUBRID Driver};server=" &amp; strIP &amp; ";port=" &amp; strPort &amp; ";uid=" &amp; strUser &amp; ";pwd=" &amp; strPass &amp; ";db_name=" &amp; strName &amp; ";"<br />
' DB연결<br />
Set DBConn = Server.CreateObject("ADODB.Connection")<br />
&#160;&#160;&#160;&#160;&#160;&#160; DBConn.Open strDsn<br />
&#160;&#160;&#160; ' SQL 실행<br />
&#160;&#160;&#160; Set rs = DBConn.Execute( strQuery )<br />
&#160;&#160;&#160; ' SQL문에 따라 메시지 보이기<br />
&#160;&#160;&#160; if InStr(Ucase(strQuery),"INSERT")&gt;0 then<br />
&#160;&#160;&#160;&#160;&#160;&#160;&#160; Response.Write "레코드가 추가되었습니다."<br />
&#160;&#160;&#160;&#160;&#160;&#160;&#160; Response.End<br />
&#160;&#160;&#160; end if<br />
&#160;&#160;&#160;&#160;&#160;&#160;&#160;<br />
&#160;&#160;&#160; if InStr(Ucase(strQuery),"DELETE")&gt;0&#160; then<br />
&#160;&#160;&#160;&#160;&#160;&#160;&#160; Response.Write "레코드가 삭제되었습니다."<br />
&#160;&#160;&#160;&#160;&#160;&#160;&#160; Response.End<br />
&#160;&#160;&#160; end if<br />
&#160;&#160;&#160;&#160;&#160;&#160;&#160;<br />
&#160;&#160;&#160; if InStr(Ucase(strQuery),"UPDATE")&gt;0&#160; then<br />
&#160;&#160;&#160;&#160;&#160;&#160;&#160; Response.Write "레코드가 수정되었습니다."<br />
&#160;&#160;&#160;&#160;&#160;&#160;&#160; Response.End<br />
&#160;&#160;&#160; end if&#160;&#160;&#160;<br />
%&gt;<br />
&lt;table&gt;<br />
&lt;%&#160;&#160;&#160;<br />
&#160;&#160;&#160; ' 필드 이름 보여주기<br />
&#160;&#160;&#160; Response.Write "&lt;tr bgColor=#f3f3f3&gt;"<br />
&#160;&#160;&#160; For index =0 to ( rs.fields.count-1 )<br />
&#160;&#160;&#160;&#160;&#160;&#160;&#160; Response.Write "&lt;td&gt;&lt;b&gt;" &amp; rs.fields(index).name &amp; "&lt;/b&gt;&lt;/td&gt;"<br />
&#160;&#160;&#160; Next<br />
&#160;&#160;&#160; Response.Write "&lt;/tr&gt;"<br />
&#160;&#160;&#160; ' 필드 값 보여주기<br />
&#160;&#160;&#160; Do While Not rs.EOF<br />
&#160;&#160;&#160;&#160;&#160;&#160;&#160; Response.Write "&lt;tr bgColor=#f3f3f3&gt;"<br />
&#160;&#160;&#160;&#160;&#160;&#160;&#160; For index =0 to ( rs.fields.count-1 )<br />
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Response.Write "&lt;td&gt;" &amp; rs(index) &amp; "&lt;/td&gt;"<br />
&#160;&#160;&#160;&#160;&#160;&#160;&#160; Next<br />
&#160;&#160;&#160;&#160;&#160;&#160;&#160; Response.Write "&lt;/tr&gt;"<br />
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;<br />
&#160;&#160;&#160;&#160;&#160;&#160;&#160; rs.MoveNext<br />
&#160;&#160;&#160; Loop<br />
%&gt;<br />
&lt;%&#160;<br />
&#160;&#160;&#160; set&#160; rs = nothing<br />
%&gt;<br />
&lt;/table&gt;</p>
<p>http://localhost/ASP수행폴더/cubrid.asp에 접속하면 수행 결과를 확인할 수 있다. 위의 ASP 예제 코드를 실행하면 다음과 같은 결과를 출력한다. 해당 항목에 알맞은 값을 넣고 Query 항목에 질의문을 입력하고 [실행하기]를 클릭하면 하단에 질의 문의 결과가 출력된다.</p>
<p><img title="image019.png" src="images/gs_app_odbc_asp_querytest.png" width="618" height="589" border="0" alt="" />&#160;</p>
<script type="text/javascript" language="javascript1.2">//<![CDATA[
<!--
if (window.writeIntopicBar)
	writeIntopicBar(0);


highlightSearch();
//-->
//]]></script>
</body>
</html>
